<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundoteknologia - Portfólio de Desenvolvimento Web e Mobile</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
</head>
<body>
    <!-- Botão para alternar tema -->
    <button id="toggle-theme" style="position: fixed;top: 10px;right: 14px;z-index: 100;background: var(--card-dark);color: var(--accent);border: none;border-radius: 14px;box-shadow: 4px 4px 12px #d7d7d9, -4px -4px 12px #23272f;font-size: 0.7rem;font-weight: 700;padding: 0.5rem 0.5rem;cursor: pointer;transition: background 0.2s, color 0.2s, box-shadow 0.2s;">☀️Modo</button>
    <!-- Efeito criativo de partículas no fundo -->
    <div class="particles-bg">
      <div class="particle" style="top:10%;left:15%;width:18px;height:18px;animation-delay:0s;"></div>
      <div class="particle" style="top:40%;left:70%;width:24px;height:24px;animation-delay:2s;"></div>
      <div class="particle" style="top:10%;left:30%;width:14px;height:14px;animation-delay:2s;"></div>
      <div class="particle" style="top:60%;left:50%;width:22px;height:22px;animation-delay:2s;"></div>
      <div class="particle" style="top:20%;left:80%;width:16px;height:16px;animation-delay:4s;"></div>
    </div>

    <header class="header-dark">
        <nav class="nav-dark">
            <div class="logo-dark">Mundoteknologia</div>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#portfolio">Portfólio</a></li>
                <li><a href="#about">Sobre</a></li>
                <li><a href="#contact">Contato</a></li>
                <li><a href="#admin" id="admin-btn" style="display:none;">Admin</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- ...seções existentes... -->
        <section id="contact" class="contact-section-dark">
            <h3>Entre em Contato</h3>
            <form id="contact-form">
                <input type="text" id="nome" placeholder="Seu Nome" required>
                <input type="email" id="email" placeholder="Seu Email" required>
                <textarea id="mensagem" placeholder="Sua Mensagem" required></textarea>
                <button type="submit" class="btn-dark highlight">Enviar Mensagem</button>
            </form>
            <p style="text-align:center; color:#bdbdbd; margin-top:1rem;">
                Ou envie um e-mail para <b>mundoteknologia@gmail.com</b>
            </p>
            <div style="text-align:center; margin-top:1rem;">
                <a id="btn-whatsapp" class="btn-dark small" style="margin-right:10px;" href="https://wa.me/seunumerowhatsapp" target="_blank">
                    <img src="images/whats.png" alt="WhatsApp" style="height:24px;vertical-align:middle;margin-right:6px;">WhatsApp
                </a>
                <a id="btn-instagram" class="btn-dark small" href="https://instagram.com/seuusuario" target="_blank">
                    <img src="images/insta.png" alt="Instagram" style="height:24px;vertical-align:middle;margin-right:6px;">Instagram
                </a>
            </div>
        </section>
        <section id="admin" class="about-section-dark" style="display:none;">
            <h3>Mensagens Recebidas</h3>
            <div id="mensagens-list"></div>
            <button id="logout-admin" class="btn-dark small" style="margin-top:1rem;display:none;">Sair</button>
            <form id="admin-register-form" style="display:none; margin-top:2rem;">
                <h4>Criar Conta de Administrador</h4>
                <input type="email" id="admin-register-email" placeholder="E-mail do administrador" required style="margin-bottom:8px;">
                <input type="password" id="admin-register-senha" placeholder="Senha" required style="margin-bottom:8px;">
                <button type="submit" class="btn-dark small">Criar Conta</button>
            </form>
        </section>
    </main>

    <footer class="footer-dark">
        <p>&copy; 2025 Mundoteknologia. Todos os direitos reservados.</p>
    </footer>
    <script src="js/script.js"></script>
    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut, createUserWithEmailAndPassword, fetchSignInMethodsForEmail } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAbsVCpF09twr4wpCYHB_cbA1oNkCuqtj0",
        authDomain: "site-mundoteknologia.firebaseapp.com",
        projectId: "site-mundoteknologia",
        storageBucket: "site-mundoteknologia.appspot.com",
        messagingSenderId: "171461943616",
        appId: "1:171461943616:web:07cb0ada17038be0641aa5",
        measurementId: "G-EJTL4ERWMP",
        databaseURL: "https://site-mundoteknologia-default-rtdb.firebaseio.com"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth(app);

    // Envio do formulário para o Firebase
    document.getElementById('contact-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const nome = document.getElementById('nome').value;
        const email = document.getElementById('email').value;
        const mensagem = document.getElementById('mensagem').value;
        push(ref(db, 'mensagens'), {
            nome,
            email,
            mensagem,
            data: new Date().toISOString()
        }).then(() => {
            alert('Mensagem enviada com sucesso!');
            document.getElementById('contact-form').reset();
        }).catch(() => {
            alert('Erro ao enviar mensagem.');
        });
    });

    // Exibe botão admin
    document.getElementById('admin-btn').style.display = 'inline-block';

    // Login admin seguro usando Firebase Authentication
    document.getElementById('admin-btn').addEventListener('click', async function(e) {
        e.preventDefault();
        if (!auth.currentUser) {
            const email = prompt("Digite o e-mail do administrador:");
            if (!email) return;
            // Verifica se o e-mail já está cadastrado
            const methods = await fetchSignInMethodsForEmail(auth, email);
            if (methods.length === 0) {
                // Não cadastrado, exibe formulário de cadastro
                document.getElementById('admin-register-form').style.display = 'block';
                document.getElementById('admin-register-email').value = email;
            } else {
                // Já cadastrado, pede senha e faz login
                const senha = prompt("Digite a senha:");
                signInWithEmailAndPassword(auth, email, senha)
                    .then(() => {
                        document.getElementById('admin').style.display = 'block';
                        document.getElementById('logout-admin').style.display = 'inline-block';
                        document.getElementById('admin-register-form').style.display = 'none';
                        carregarMensagens();
                    })
                    .catch(() => {
                        alert("Acesso negado.");
                    });
            }
        } else {
            document.getElementById('admin').style.display = 'block';
            document.getElementById('logout-admin').style.display = 'inline-block';
            document.getElementById('admin-register-form').style.display = 'none';
            carregarMensagens();
        }
    });

    // Cadastro de novo admin
    document.getElementById('admin-register-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('admin-register-email').value;
        const senha = document.getElementById('admin-register-senha').value;
        createUserWithEmailAndPassword(auth, email, senha)
            .then(() => {
                alert('Administrador cadastrado com sucesso!');
                document.getElementById('admin').style.display = 'block';
                document.getElementById('logout-admin').style.display = 'inline-block';
                document.getElementById('admin-register-form').style.display = 'none';
                carregarMensagens();
            })
            .catch((error) => {
                alert('Erro ao cadastrar administrador: ' + error.message);
            });
    });

    // Logout admin
    document.getElementById('logout-admin').addEventListener('click', function() {
        signOut(auth).then(() => {
            document.getElementById('admin').style.display = 'none';
            document.getElementById('logout-admin').style.display = 'none';
            document.getElementById('admin-register-form').style.display = 'none';
        });
    });

    // Carregar mensagens do Firebase
    function carregarMensagens() {
        const lista = document.getElementById('mensagens-list');
        lista.innerHTML = "<p>Carregando...</p>";
        onValue(ref(db, 'mensagens'), (snapshot) => {
            let html = "";
            snapshot.forEach(function(child) {
                const msg = child.val();
                html += `<div style="border:1px solid #ccc;padding:8px;margin-bottom:8px;">
                    <b>Nome:</b> ${msg.nome}<br>
                    <b>Email:</b> ${msg.email}<br>
                    <b>Mensagem:</b> ${msg.mensagem}<br>
                    <small>${msg.data}</small>
                </div>`;
            });
            lista.innerHTML = html || "<p>Nenhuma mensagem recebida.</p>";
        });
    }

    // Exibe admin se já autenticado
    onAuthStateChanged(auth, (user) => {
        if (user) {
            document.getElementById('admin').style.display = 'block';
            document.getElementById('logout-admin').style.display = 'inline-block';
            document.getElementById('admin-register-form').style.display = 'none';
            carregarMensagens();
        } else {
            document.getElementById('admin').style.display = 'none';
            document.getElementById('logout-admin').style.display = 'none';
            document.getElementById('admin-register-form').style.display = 'none';
        }
    });
    </script>
</body>
</html>